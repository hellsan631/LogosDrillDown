(function(){"use strict";var e=0,t=["ms","moz","webkit","o"],n;for(n=0;n<t.length&&!window.requestAnimationFrame;n+=1){window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(t,n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),s=window.setTimeout(function(){t(r+i)},i);e=r+i;return s}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(e){clearTimeout(e)}}})();(function(e){"use strict";var t="logosDrillDown",n={init:function(n){n=e.extend({},e.fn.logosDrillDown.defaults,n);return this.each(function(){var i=e(this).addClass(n.myClass),o=e(">ul",i),u=[],a=i.width();i.data(t,{options:n,$menu:o,path:[],pathNumerical:[],offset:o.width(),keysActive:false});c.apply(i,[o]);window.requestAnimationFrame(function(){i.css("width",a+"px")});window.requestAnimationFrame(function(){e("ul",o).css({width:a+"px",left:a+"px"})});if(n.keyboardNavigation){var f=false;e(document).bind("keyup",function(r){if(r.keyCode==77&&r.ctrlKey){var s=i.data(t);s.keysActive=!s.keysActive;if(s.keysActive){var o=i.data(t).path;var u;if(o.length){u=e(">li:eq(0)",o[o.length-1].nextAll("ul"))}else{u=e(">li:eq(0)",i.data(t).$menu)}u.addClass(n.activeClass)}}return true});e(document).bind("keyup",function(n){var r=i.data(t);if(!r.keysActive&&e(":focus",i).length==0){return true}switch(n.keyCode){case 8:case 13:case 37:case 38:case 39:case 40:d.apply(i,[n.keyCode]);break}return false})}if(n.ajax){e(document).on(n.event,"li."+n.expandableClass+" > a",function(){var t=e(this);if(!e(this).nextAll("ul").length){e.ajax({type:"GET",url:t.attr("href"),dataType:"html",success:function(e){t.after(e);p.apply(i,t.nextAll("ul"));i.logosDrillDown("goTo",t)}})}else{i.logosDrillDown("goTo",e(this))}return false})}else{e("a",o).each(function(){var t=false;if(e(this).nextAll("ul").length>0){e(this).parent().addClass(n.expandableClass);t=true}e(this).bind(n.event,function(){if(!t){return true}i.logosDrillDown("goTo",e(this));return false});if(e(this).hasClass(n.currentClass)){e(this).removeClass(n.currentClass);var s=e(this).closest("li."+n.expandableClass),o;o=e(">a",s).addClass(n.currentClass);u=r.apply(i,[o])}});if(n.useCookies){var h=l(t);if(h!==null&&h!==""){var v=h.split(",");if(v.length>0){u=v}}}if(u.length>0){s.apply(i,[u,false]);i.dequeue(t)}}})},goTo:function(n,i){return this.each(function(){var o=e(this),a=o.data(t),f=a.pathNumerical,l=a.options,c=0,h=0;if(i===undefined){i=true}if(n===undefined||n===null){return false}if(!a.$menu.has(n).length){o.logosDrillDown("goTop",i);return false}if(!n.closest("li").hasClass(l.expandableClass)){o.logosDrillDown("goTo",n.closest("li."+l.expandableClass).find(">a"),i);return false}var p=r.apply(o,[n]),d=f.length,v=[];for(var m=0;m<p.length;m++){if(d<m){v=p.slice(m,p.length);break}if(p[m]!==f[m]){c=f.length-m;for(h=0;h<c;h++){u.apply(o,[i])}v=p.slice(m,p.length);break}}if(p.length<f.length&&v.length===0){c=f.length-p.length;for(h=0;h<c;h++){u.apply(o,[i])}}s.apply(o,[v,i]);o.dequeue(t);return false})},goTop:function(n){return this.each(function(){var r=e(this),i=r.data(t);if(n===undefined){n=true}r.logosDrillDown("goUp",i.path.length,n)})},goUp:function(n,r){if(r===undefined){r=true}return this.each(function(){if(n===0){return}var i=e(this);for(var s=0;s<n;s++){u.apply(i,[r])}i.dequeue(t);return false})},option:function(n,r){if(typeof n==="string"){var i=e(this),s=i.data(t);if(r===undefined){return s.options[n]}else{s.options[n]=r;i.data(t,s);return this}}return false},search:function(n,r,i){if(n===""){return[]}if(r===undefined){r=true}if(i===undefined){i=false}var s=e(this),o=s.data(t),u=o.options,a=new RegExp(n,"i"),f=o.$menu,l=[];var c=e("li > a",f);c.filter("."+u.matchClass).removeClass(u.matchClass);c.each(function(){if(e(this).text().match(a)){e(this).addClass(u.matchClass);l.push(e(this))}});if(r&&l.length===1){var h=e(l[0]).parents("li");if(h.length<2){s.logosDrillDown("goTop",i)}else{s.logosDrillDown("goTo",e(">a",h[1]),i)}}return l},searchWrapper:function(t,n,r,i){return this.each(function(){var s=e(this);t.submit(function(){var o=e("input[type=text]",t).val(),u=s.logosDrillDown("search",o,r,i);n.html("");if(u.length>1){var a=e("<div></div>");e.each(u,function(e,t){var n=s.logosDrillDown("getBreadcrumbs",t);var r=s.logosDrillDown("getBreadcrumbsFormatted",n,i);a.append(r)});n.html(a)}return false})})},getBreadcrumbs:function(t){return a.apply(e(this),[t])},getBreadcrumbsFormatted:function(t,n){var r=e(this);if(t===undefined){t=r.logosDrillDown("getBreadcrumbs")}if(n===undefined){n=true}var i=e('<div class="breadcrumbs"></div>');e.each(t,function(t,s){var o=e("<span>"+e(s).text()+"</span>").bind("click",function(){r.logosDrillDown("goTo",s,n);return false});i.append(o).append(" ")});return i},windowResizeEvent:function(){var n=e(this),r=e(window).width(),i=n.data(t),s=e(">ul",n),o=i.path.length-1;i.offset=r;if(o>=0){e("ul",s).each(function(t){var n=this;if(t<o){window.requestAnimationFrame(function(){e(n).css({width:r+"px",left:0+"px"})})}else{window.requestAnimationFrame(function(){e(n).css({width:r+"px",left:r+"px"})})}});window.requestAnimationFrame(function(){e(s).css({width:r+"px",left:-r+"px"})})}else{e("ul",s).each(function(){var t=this;window.requestAnimationFrame(function(){e(t).css({width:r+"px",left:r+"px"})})});window.requestAnimationFrame(function(){e(s).css({width:r+"px",left:0+"px"})})}window.requestAnimationFrame(function(){n.css("width",r+"px")})}};var r=function(n){var r=e(this),i=r.data(t),s=[];n.parentsUntil("."+i.options.myClass,"li").each(function(){s.push(e(this).index())});return s.reverse()};var i=function(n){var r=e(this),i=r.data(t),s=[];n.parentsUntil("."+i.options.myClass,"li").each(function(){s.push(e(">a",e(this)))});return s.reverse()};var s=function(n,r){var i=e(this),u=i.data(t),a=u.$menu,f=u.pathNumerical,l=u.path;if(n.length===0){return false}if(f.length===0){o.apply(i,[e(">li:eq("+n[0]+")>a",a),r])}else{o.apply(i,[l[l.length-1].nextAll("ul").find(">li:eq("+n[0]+")>a"),r])}return s.apply(i,[n.slice(1,n.length),r])};var o=function(n,r){var i=e(this),s=i.data(t),o=s.options,u=s.path,a=s.pathNumerical;var l=n.closest("ul");var p=n.nextAll("ul");o.onBeforeOpen(n);var d=o.duration;if(!r){d=0}i.queue(t,function(t){p.show();if(o.heightAutoAdjust){c.apply(i,[p])}if(e.isFunction(l.velocity)){l.velocity({left:"-="+s.offset},{duration:d,easing:o.easing,complete:function(){t()}})}else{l.animate({left:"-="+s.offset},{duration:d,easing:o.easing,complete:function(){t()}})}});u.push(n);a.push(n.closest("li").index());if(o.useCookies){f(t,a)}s.path=u;s.pathNumerical=a;i.data(t,s);o.onOpened(n);i.trigger("drilldownchange",[n,true]);if(o.ajaxPreloading){h.apply(i,[n])}return false};var u=function(n){var r=e(this),i=r.data(t),s=i.$menu,o=i.options,u=i.path,a=i.pathNumerical;var l=u.pop();if(l===null){return}var h=l.closest("ul");var p=l.nextAll("ul");var d=o.duration;if(n===false){d=0}o.onBeforeClose(l);r.queue(t,function(t){if(e.isFunction(h.velocity)){h.velocity({left:"+="+i.offset},{duration:d,easing:o.easing,complete:function(){p.hide();t()},display:"block"})}else{h.show();h.animate({left:"+="+i.offset},{duration:d,easing:o.easing,complete:function(){p.hide();t()}})}if(o.heightAutoAdjust){c.apply(r,[h])}});a.pop();if(o.useCookies){f(t,a)}i[a]=a;i[u]=u;r.data(t,i);var v=u[u.length-1];o.onClosed(l);r.trigger("drilldownchange",[v,false])};var a=function(n){var r=e(this),s=r.data(t),o=[];var u=s.path;if(n!==undefined){u=i.apply(r,[n])}if(u.length>0){o.push(e('<span class="">'+s.options.startName+"</span>"))}return o.concat(u)};var f=function(e,t,n){var r="";if(n){var i=new Date;i.setTime(i.getTime()+n*24*60*60*1e3);r="; expires="+i.toUTCString()}document.cookie=e+"="+t+r+"; path=/"};var l=function(e){var t=e+"=",n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)===" "){i=i.substring(1,i.length)}if(i.indexOf(t)===0){return i.substring(t.length,i.length)}}return null};var c=function(n){var r=e(this),i=n.data(t),s;if(i!==undefined){s=i.height}else{s=n.height();i={height:s};n.data(t,i)}if(e.isFunction(r.velocity)){r.velocity({height:s},{duration:200})}else{r.animate({height:s},{duration:200})}};var h=function(n){var r=e(this),i=r.data(t),s=i.options;n.nextAll("ul").find("li."+s.expandableClass+">a").each(function(){var t=e(this);if(t.nextAll("ul").length>0){return}e.ajax({type:"GET",url:t.attr("href"),dataType:"html",success:function(e){t.after(e);p.apply(r,t.nextAll("ul"))}})})};var p=function(n){var r=e(this),i=r.data(t);window.requestAnimationFrame(function(){e(n).css({width:i.$menu.width()+"px",left:i.$menu.width()+"px"})});i.$menu=e(">ul",r);r.data(t,i)};var d=function(n){var r=e(this),i=r.data(t),s=i.path,o=i.options,u=i.$menu;if(s.length>0){var a=s[s.length-1];u=a.nextAll("ul")}else{if(n===37){return}}var f=e("> li."+o.activeClass,u);if(n===37||n===8){r.logosDrillDown("goUp",1);f.removeClass(o.activeClass);u.parent().parent("ul").find(">li:eq(0)").addClass(o.activeClass);return}if(n===39||n===13){var l=e(">a",f);if(!f.hasClass(o.expandableClass)){if(n===13&&l.length){window.location=l.attr("href")}return}if(l.length){r.logosDrillDown("goTo",l);f.removeClass(o.activeClass);e(">li:eq(0)",l.nextAll("ul")).addClass(o.activeClass)}return}if(n===40){var c=f.next("li");if(f.length===0){c=e(">li:eq(0)",u)}}else if(n===38){var c=f.prev("li");if(f.length===0){c=e(">li:last",u)}}if(c.length>0){f.removeClass(o.activeClass);c.addClass(o.activeClass)}};e.fn.logosDrillDown=function(t){if(n[t]){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on Drill Down!");return false}};e.fn.logosDrillDown.defaults={myClass:"logosDrillDown",expandableClass:"expandable",onOpened:e.noop,onBeforeOpen:e.noop,onClosed:e.noop,onBeforeClose:e.noop,duration:300,easing:"linear",currentClass:"current",useCookies:false,heightAutoAdjust:true,matchClass:"match",startName:"Start",ajax:false,ajaxPreloading:true,event:"click",keyboardNavigation:true,activeClass:"active"}})(jQuery)